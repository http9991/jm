function getXmlHttp() {
    var e;
    try {
        e = new ActiveXObject("Msxml2.XMLHTTP")
    } catch (t) {
        try {
            e = new ActiveXObject("Microsoft.XMLHTTP")
        } catch (n) {
            e = !1
        }
    }
    return e || "undefined" == typeof XMLHttpRequest || (e = new XMLHttpRequest), e
}

function tel_conf_send() {
    document.getElementById('tel_confsignup').disabled = false;
    $('#loader-wrapper').removeClass('hidden');
    setTimeout(tel_conf_send_true, 2000);
};

function tel_conf_send_true() {
    var SITELOGIN = "kadrovmax";
    var SITEPASS = "E56X6AKLl"
    var to = $("#usernamesignup").intlTelInput("getNumber");
    var code = +(randomInteger(1000000, 9999999));
    var message = 'Ваш код: ';
    var text = message + code;
    var codirovka = 'utf-8';
    var xmlhttp_send_sms = getXmlHttp(); // Создаём объект XMLHTTP
    xmlhttp_send_sms.open('POST', 'http://smsc.ru/sys/send.php', true); // Открываем асинхронное соединение
    xmlhttp_send_sms.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); // Отправляем кодировку
    xmlhttp_send_sms.send("login=" + encodeURIComponent(SITELOGIN) + "&psw=" + encodeURIComponent(SITEPASS) + "&phones=" + encodeURIComponent(to) + "&mes=" + encodeURIComponent(text) + "&charset=" + encodeURIComponent(codirovka));
    $('#loader-wrapper').removeClass('hidden');
    var usernamesignup = $("#usernamesignup").intlTelInput("getNumber");
    var xmlhttp_save = getXmlHttp(); // Создаём объект XMLHTTP
    xmlhttp_save.open('POST', 'telephone_save.php', true); // Открываем асинхронное соединение
    xmlhttp_save.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded'); // Отправляем кодировку
    xmlhttp_save.send("usernamesignup=" + encodeURIComponent(to) + "&verification_code=" + encodeURIComponent(code)); // Отправляем POST-запрос
    document.getElementById('tel_confsignup').disabled = false;
    $('#loader-wrapper').addClass('hidden');
};

function randomInteger(min, max) {
    var rand = min - 0.5 + Math.random() * (max - min + 1)
    rand = Math.round(rand);
    return rand;
};